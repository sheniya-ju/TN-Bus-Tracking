<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Panel | TN Bus Tracker</title>
<link rel="stylesheet" href="../style.css">
<style>
body { font-family:"Poppins", sans-serif; background:#F5F5F0; margin:0; padding:0; }
.header { background:#5D866C; color:white; padding:15px; text-align:center; position:sticky; top:0; font-size:1.5rem; }
.logout-btn { position:absolute; top:10px; right:20px; background:#C2A68C; color:white; border:none; padding:6px 12px; border-radius:5px; cursor:pointer; }
.logout-btn:hover { background:#E6D8C3; color:#5D866C; }
.container { padding:20px; display:flex; flex-direction:column; gap:20px; }
.assign-box { background:#E6D8C3; padding:15px; border-radius:12px; max-width:400px; }
.assign-box input, .assign-box select, .assign-box button { width:100%; padding:10px; margin:8px 0; border-radius:6px; border:1px solid #C2A68C; }
.assign-box button { background:#5D866C; color:white; border:none; cursor:pointer; }
.assign-box button:hover { background:#C2A68C; }
</style>
</head>
<body>

<div class="header">
  Admin Panel
  <button class="logout-btn" onclick="logout()">Logout</button>
</div>

<div class="container">
  <div class="assign-box">
    <h3>Assign Driver to Bus</h3>
    <input type="text" id="driverEmail" placeholder="Driver Email">
    <input type="text" id="busNo" placeholder="Bus Number">
    <input type="text" id="route" placeholder="Route Name">
    <input type="text" id="duration" placeholder="Duration (e.g., 8AM-4PM)">
    <button id="assignBtn">Assign Driver</button>
    <p id="assignStatus"></p>
  </div>
</div>

<script type="module">
import { assignDriver, auth, signOut } from "../firebase.js";

window.logout = async () => { await signOut(auth); window.location.href='./login.html'; }

document.getElementById("assignBtn").addEventListener("click", async ()=>{
  const email = document.getElementById("driverEmail").value.trim();
  const busNo = document.getElementById("busNo").value.trim();
  const route = document.getElementById("route").value.trim();
  const duration = document.getElementById("duration").value.trim();
  const statusEl = document.getElementById("assignStatus");

  if(!email||!busNo||!route||!duration){ statusEl.textContent="Fill all fields!"; statusEl.style.color="red"; return; }

  try {
    const res = await assignDriver(email, busNo, route, duration);
    statusEl.textContent = res.message;
    statusEl.style.color="green";

    // Clear inputs
    document.getElementById("driverEmail").value="";
    document.getElementById("busNo").value="";
    document.getElementById("route").value="";
    document.getElementById("duration").value="";
  } catch(err){
    statusEl.textContent = err.message;
    statusEl.style.color="red";
  }
});
</script>
</body>
</html>
